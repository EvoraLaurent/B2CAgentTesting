<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B2C Agent Testing</title>
    <!-- Add meta tags for security -->
    <meta http-equiv="Content-Security-Policy" content="frame-ancestors 'self' https://jpw--agentforce.sandbox.my.site.com">
    <meta http-equiv="X-Frame-Options" content="ALLOW-FROM https://jpw--agentforce.sandbox.my.site.com">
</head>
<body>
    <h1>B2C Agent Testing Page</h1>
    <div id="status-message"></div>
    
    <script type='text/javascript'>
    function initEmbeddedMessaging() {
        try {
            if (!window.embeddedservice_bootstrap) {
                console.error('Embedded service bootstrap not loaded');
                document.getElementById('status-message').innerHTML = 
                    'Error: Embedded service bootstrap not loaded';
                return;
            }

            embeddedservice_bootstrap.settings.language = 'en_US';
            
            embeddedservice_bootstrap.init(
                '00DcX000001g9cb',
                'B2C_Agent',
                'https://jpw--agentforce.sandbox.my.site.com/ESWB2CAgent1737056033633',
                {
                    scrt2URL: 'https://jpw--agentforce.sandbox.my.salesforce-scrt.com',
                    onInit: function(err, bootstrapResponse) {
                        if (err) {
                            console.error('Embedded Messaging initialization error:', err);
                            document.getElementById('status-message').innerHTML = 
                                'Unable to load messaging service: ' + err.message;
                        } else {
                            console.log('Embedded Messaging initialized successfully');
                            document.getElementById('status-message').innerHTML = 
                                'Messaging service loaded successfully';
                        }
                    }
                }
            );
        } catch (err) {
            console.error('Error in initEmbeddedMessaging:', err);
            document.getElementById('status-message').innerHTML = 
                'Error initializing messaging service: ' + err.message;
        }
    }
    </script>
    <script type='text/javascript' 
            src='https://jpw--agentforce.sandbox.my.site.com/ESWB2CAgent1737056033633/assets/js/bootstrap.min.js' 
            onload='initEmbeddedMessaging()'
            onerror='function(error) { 
                console.error("Failed to load bootstrap script:", error);
                document.getElementById("status-message").innerHTML = 
                    "Failed to load messaging service script";
            }'>
    </script>
</body>
</html>
